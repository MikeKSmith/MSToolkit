<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The analyzeRep function analyzes a single replicate of data, possibly
at different interim levels."><title>Analyse a single replicate of data — analyzeRep • MSToolkit</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyse a single replicate of data — analyzeRep"><meta property="og:description" content="The analyzeRep function analyzes a single replicate of data, possibly
at different interim levels."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MSToolkit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MSToolkit_intro_vig.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/generate_data.html">generateData</a>
    <a class="dropdown-item" href="../articles/analyze_data.html">analyzeData</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Background Reading</h6>
    <a class="dropdown-item" href="../articles/simulation_overview.html">Simulation Overview</a>
    <a class="dropdown-item" href="../articles/references.html">References</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MikeKSmith/MSToolkit/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Analyse a single replicate of data</h1>
      <small class="dont-index">Source: <a href="https://github.com/MikeKSmith/MSToolkit/blob/HEAD/R/analyzeRep.R" class="external-link"><code>R/analyzeRep.R</code></a></small>
      <div class="d-none name"><code>analyzeRep.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>analyzeRep</code> function analyzes a single replicate of data, possibly
at different interim levels.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">analyzeRep</span><span class="op">(</span></span>
<span>  <span class="va">analysisCode</span>,</span>
<span>  <span class="va">replicate</span>,</span>
<span>  removeMissing <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  removeParOmit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  removeRespOmit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interimCode <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  software <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"SAS"</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fu">.deriveFromMasterSeed</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  parOmitFlag <span class="op">=</span> <span class="fu"><a href="getEctdColName.html">getEctdColName</a></span><span class="op">(</span><span class="st">"ParOmit"</span><span class="op">)</span>,</span>
<span>  respOmitFlag <span class="op">=</span> <span class="fu"><a href="getEctdColName.html">getEctdColName</a></span><span class="op">(</span><span class="st">"RespOmit"</span><span class="op">)</span>,</span>
<span>  missingFlag <span class="op">=</span> <span class="fu"><a href="getEctdColName.html">getEctdColName</a></span><span class="op">(</span><span class="st">"Missing"</span><span class="op">)</span>,</span>
<span>  interimCol <span class="op">=</span> <span class="fu"><a href="getEctdColName.html">getEctdColName</a></span><span class="op">(</span><span class="st">"Interim"</span><span class="op">)</span>,</span>
<span>  doseCol <span class="op">=</span> <span class="fu"><a href="getEctdColName.html">getEctdColName</a></span><span class="op">(</span><span class="st">"Dose"</span><span class="op">)</span>,</span>
<span>  initialDoses <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stayDropped <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fullAnalysis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  workingPath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="setEctdDataMethod.html">getEctdDataMethod</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>analysisCode</dt>
<dd><p>(Required) File containing analysis code (for R or SAS)
or an R function for analysis (R only)</p></dd>


<dt>replicate</dt>
<dd><p>(Required) Replicate number of data to be analyzed</p></dd>


<dt>removeMissing</dt>
<dd><p>(Optional) Should rows marked as 'Missing' during the
data generation step be removed from the data before analysis is performed?
TRUE by default</p></dd>


<dt>removeParOmit</dt>
<dd><p>(Optional) Should any rows marked as 'Omitted' during
the parameter data generation step (ie. parameters out of range) be removed
from the data before analysis is performed?  TRUE by default</p></dd>


<dt>removeRespOmit</dt>
<dd><p>(Optional) Should any rows marked as 'Omitted' during
the response generation step (ie. responses out of range) be removed from
the data before analysis is performed?  TRUE by default</p></dd>


<dt>interimCode</dt>
<dd><p>(Optional) An R function to be applied to interim
datasets in order to creation interim decisions.  See the help file for the
<code><a href="interimAnalysis.html">interimAnalysis</a></code> function for more information.  By default, no
functions is provided, resulting in no interim analyses being performed</p></dd>


<dt>software</dt>
<dd><p>(Optional) The software to be used for analysis: either "R"
or "SAS".  "R" is the default software used</p></dd>


<dt>seed</dt>
<dd><p>(Optional) Random number seed to use for the analysis.  Based on
the current random seed by default</p></dd>


<dt>parOmitFlag</dt>
<dd><p>(Optional) Parameter omit flag name.  "PAROMIT" by
default</p></dd>


<dt>respOmitFlag</dt>
<dd><p>(Optional) Response omit flag name.  "RESPOMIT" by
default</p></dd>


<dt>missingFlag</dt>
<dd><p>(Optional) Missing flag name.  "MISSING" by default</p></dd>


<dt>interimCol</dt>
<dd><p>(Optional) Interim variable name.  "INTERIM" by default</p></dd>


<dt>doseCol</dt>
<dd><p>(Optional) Dose variable name.  "DOSE" by default</p></dd>


<dt>initialDoses</dt>
<dd><p>(Optional) For interim analyses, which doses should be
present in interim 1?  All are included by default</p></dd>


<dt>stayDropped</dt>
<dd><p>(Optional) For interim analyses, if a dose is dropped,
should it stay dropped in following interims (as opposed to allowing the
interim step to reopen the dose)</p></dd>


<dt>fullAnalysis</dt>
<dd><p>(Optional) Should a "full" analysis be performed on all
doses?  Default TRUE</p></dd>


<dt>workingPath</dt>
<dd><p>(Optional) Root directory in which replicate data is
stored, and in which we should perform the analysis.  Current working
directory is used by default</p></dd>


<dt>method</dt>
<dd><p>Data storage method (ie. where the replicate data is stored).
Given by <a href="setEctdDataMethod.html">getEctdDataMethod</a> by default</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A "Micro Evaluation" structure with additional variables (interim
column, drop flag and stop flag)</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>analyzeRep</code> function calls the
<code><a href="performAnalysis.html">performAnalysis</a></code> function in order to analyze and summarize a
single simulated replicate dataset (held in the "ReplicateData" subdirectory
of the specified working path).</p>
<p>The first step of the analysis is to use the removeMissing, removeParOmit
and removeRespOmit flags (together with the missingFlag, parOmitFlag and
respOmitFlag inputs) in order to subset the data if required.  For example,
we may wish to remove all observations flagged as "missing" in an earlier
simulation of subject dropout.  The subset is applied to the data before the
analysis.</p>
<p>The analysis code must be either an R function, a reference to an external R
script, or a reference to an external SAS script.  If the software is set as
"SAS", it is assumed that the analysisCode is an external SAS script.  If
the analysis code is a SAS script, it must accept a single dataset called
work.infile, and create an output dataset called work.outfile.  The
work.outfile dataset must be a valid "Micro Evaluation" structure as
specified in the help file for <code><a href="checkMicroFormat.html">checkMicroFormat</a></code>.  If the
software is "R", the analysis code input must be either an R function or an
R script.  The R analysis code must also return a valid "Micro Evaluatoin"
structure as specified in function <code><a href="checkMicroFormat.html">checkMicroFormat</a></code></p>
<p>The first step in <code>analyzeRep</code> is to perform a full analysis on
the data (which has possibly been subset be the remove* inputs).  Following
the analysis, the <code><a href="checkMicroFormat.html">checkMicroFormat</a></code> function is used to ensure
the return data is a valid "Micro Evaluation" data structure.  The return
structure is appended with drop and stop flags (set to 0) and with interim
variables (where interim is "FULL").</p>
<p>If the interimCode has been specified, and the "interimCol" variable is
found in the data, interim analyses will be performed iteratively on
sections of the data.  The interimCode input must be an R function that
returns a suitable list structure as described in the
<code><a href="interimAnalysis.html">interimAnalysis</a></code> help file.  For each value of "interimCol",
the analysis will be performed on a section of data (using a call to
<code><a href="performAnalysis.html">performAnalysis</a></code>), and the return from the analysis will be
checked (using a call to <code><a href="checkMicroFormat.html">checkMicroFormat</a></code>).  The "Micro
Evaluation" output is then passed to the <code><a href="interimAnalysis.html">interimAnalysis</a></code>
function and the return list checked for instruction.  If any return interim
list includes doses to "DROP", the doses will be removed from future
analyses.  If the "STOP" flag in the list is set to "TRUE", the analysis is
stopped at this interim.</p>
<p>Finally, all micro evaluation outputs (with appended interim variables and
drop/stop flags) are combined and returned.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="performAnalysis.html">performAnalysis</a></code> is called by <code>analyzeRep</code> to
perform each analysis on the subset of data. <code><a href="interimAnalysis.html">interimAnalysis</a></code>
executes the <code>interimCode</code> and updates the data changes accordibgly.</p>
<p><code><a href="analyzeData.html">analyzeData</a></code> calls <code>analyzeRep</code> sequentially.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Mike K Smith <a href="mailto:mstoolkit@googlemail.com">mstoolkit@googlemail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Analysis Code</span></span></span>
<span class="r-in"><span>  <span class="va">emaxFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DoseResponse</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>     <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">uniDoses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">eFit</span> <span class="op">&lt;-</span> <span class="fu">emaxalt</span><span class="op">(</span> <span class="va">RESP</span>, <span class="va">D</span> <span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">outDf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> D <span class="op">=</span> <span class="va">uniDoses</span>,</span></span>
<span class="r-in"><span>      MEAN <span class="op">=</span> <span class="va">eFit</span><span class="op">$</span><span class="va">dm</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">uniDoses</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      SE <span class="op">=</span> <span class="va">eFit</span><span class="op">$</span><span class="va">dsd</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">uniDoses</span><span class="op">)</span><span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">outDf</span><span class="op">$</span><span class="va">LOWER</span> <span class="op">&lt;-</span> <span class="va">outDf</span><span class="op">$</span><span class="va">MEAN</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">outDf</span><span class="op">$</span><span class="va">SE</span></span></span>
<span class="r-in"><span>      <span class="va">outDf</span><span class="op">$</span><span class="va">UPPER</span> <span class="op">&lt;-</span> <span class="va">outDf</span><span class="op">$</span><span class="va">MEAN</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">outDf</span><span class="op">$</span><span class="va">SE</span></span></span>
<span class="r-in"><span>      <span class="va">outDf</span><span class="op">$</span><span class="va">N</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">)</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">uniDoses</span><span class="op">)</span> <span class="op">]</span></span></span>
<span class="r-in"><span>      <span class="va">outDf</span></span></span>
<span class="r-in"><span>     <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">analyzeRep</span><span class="op">(</span>replicate <span class="op">=</span> <span class="fl">1</span>, analysisCode <span class="op">=</span> <span class="va">emaxFun</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Mike K Smith, Rich Pugh, Roman Francois, Francisco Gochez.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

