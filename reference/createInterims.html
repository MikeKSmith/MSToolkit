<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="In clinical trials there is sometimes the need to examine emerging data as
the trial progresses to make decisions about curtailing the trial early,
either due to lack of efficacy or because statistical significance is
achieved and it would be unethical to continue allocating patients to
inferior treatments. These interim assessments are usually performed after
a specified proportion of subjects have completed treatment. Thus, there is
a cumulative proportion of patients eligible at each interim assessment.
MSToolkit allows the user to specify this cumulative proportion and then
allocates subjects to each interim assessment."><title>Create the interim flag — createInterims • MSToolkit</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create the interim flag — createInterims"><meta property="og:description" content="In clinical trials there is sometimes the need to examine emerging data as
the trial progresses to make decisions about curtailing the trial early,
either due to lack of efficacy or because statistical significance is
achieved and it would be unethical to continue allocating patients to
inferior treatments. These interim assessments are usually performed after
a specified proportion of subjects have completed treatment. Thus, there is
a cumulative proportion of patients eligible at each interim assessment.
MSToolkit allows the user to specify this cumulative proportion and then
allocates subjects to each interim assessment."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MSToolkit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MSToolkit_intro_vig.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/generate_data.html">generateData</a>
    <a class="dropdown-item" href="../articles/analyze_data.html">analyzeData</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Background Reading</h6>
    <a class="dropdown-item" href="../articles/simulation_overview.html">Simulation Overview</a>
    <a class="dropdown-item" href="../articles/references.html">References</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MikeKSmith/MSToolkit/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Create the interim flag</h1>
      <small class="dont-index">Source: <a href="https://github.com/MikeKSmith/MSToolkit/blob/HEAD/R/createInterims.R" class="external-link"><code>R/createInterims.R</code></a></small>
      <div class="d-none name"><code>createInterims.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In clinical trials there is sometimes the need to examine emerging data as
the trial progresses to make decisions about curtailing the trial early,
either due to lack of efficacy or because statistical significance is
achieved and it would be unethical to continue allocating patients to
inferior treatments. These interim assessments are usually performed after
a specified proportion of subjects have completed treatment. Thus, there is
a cumulative proportion of patients eligible at each interim assessment.
MSToolkit allows the user to specify this cumulative proportion and then
allocates subjects to each interim assessment.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">createInterims</span><span class="op">(</span></span>
<span>  <span class="va">subjects</span>,</span>
<span>  <span class="va">proportion</span>,</span>
<span>  seed <span class="op">=</span> <span class="fu">.deriveFromMasterSeed</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  idCol <span class="op">=</span> <span class="fu"><a href="getEctdColName.html">getEctdColName</a></span><span class="op">(</span><span class="st">"Subject"</span><span class="op">)</span>,</span>
<span>  interimCol <span class="op">=</span> <span class="fu"><a href="getEctdColName.html">getEctdColName</a></span><span class="op">(</span><span class="st">"Interim"</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Sample"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>subjects</dt>
<dd><p>(Required) Vector of subjects or number of subjects</p></dd>


<dt>proportion</dt>
<dd><p>(Required) Vector of proportions of subjects in each
interim.  This is a vector of cumulative proportions</p></dd>


<dt>seed</dt>
<dd><p>(Optional) The random number generation seed to use.  By
default, this is derived from the current random seed</p></dd>


<dt>idCol</dt>
<dd><p>(Optional) Name of the subject column ("SUBJ" by default)</p></dd>


<dt>interimCol</dt>
<dd><p>(Optional) Name of the interim column ("INTERIM" by
default)</p></dd>


<dt>method</dt>
<dd><p>(Optional) Method to use. Must be one of <em>Sample</em> or
<em>Proportion</em>.  Default is <em>Sample</em></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data frame containing the following variables:</p>
<dl><dt>SUBJ</dt>
<dd><p>Subject
identifier, named after <code>idCol</code>.</p></dd>
 <dt>INTERIM </dt>
<dd><p>Interim flag, named
after <code>interimCol</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function creates the <em>INTERIM</em> flag that identifies which interim
analysis is the <em>FIRST</em> for each subject</p>
<p>If the "method" argument is set to "Sample", the interim numbers should be
assigned using the following algorithm: Store the number of subjects
(nSubjects) and the number of interims (nInterims) Append a zero to the
start of the proportions and take differences to get a vector of
"non-cumulative" probabilities Take "nSubjects" samples from the values "1"
to "nInterims" with probabilities set to the derived "non-cumulative"
probabilities Replace the "interim" variable with these values.</p>
<p>If the "method" argument is set to "Proportion", the interim numbers should
be assigned using the following algorithm: Store the number of subjects
(nSubjects) and the number of interims (nInterims) Convert the cumulative
proportions to "non-cumulative" probabilities. Allocate a "base" number of
subjects to each interim (found by multiplying nSubjects by the set of
probabilities, then take the floor of the resulting values) If any subjects
are left at this stage, use the "sample" method (below) to allocate the
remaining subjects to interims "Shuffle" the interim variable so that the
results are not ordered.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Romain Francois</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># first interim with 10% of the subjects</span></span></span>
<span class="r-in"><span>  <span class="co"># second with 30%</span></span></span>
<span class="r-in"><span>  <span class="co"># third with 60%</span></span></span>
<span class="r-in"><span>  <span class="va">interims</span> <span class="op">&lt;-</span> <span class="fu">createInterims</span><span class="op">(</span><span class="fl">100</span>, proportion  <span class="op">=</span> <span class="st">".1,.3,.6"</span> <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">interims</span><span class="op">$</span><span class="va">INTERIM</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1    2    3    4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.14 0.20 0.32 0.34 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co">## more examples in the unit tests</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/file.show.html" class="external-link">file.show</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"Runit"</span>, <span class="st">"runit.data.interim.R"</span>,</span></span>
<span class="r-in"><span>                package <span class="op">=</span> <span class="st">"MSToolkit"</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Mike K Smith, Rich Pugh, Roman Francois, Francisco Gochez.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer></div>

  

  

  </body></html>

