<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Simulate data, analyse this data and assess operating 
    characteristcs of clinical trials.">
<title>The MSToolkit Library For Clinical Trial Design • MSToolkit</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="The MSToolkit Library For Clinical Trial Design">
<meta property="og:description" content="Simulate data, analyse this data and assess operating 
    characteristcs of clinical trials.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">MSToolkit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/MSToolkit_intro_vig.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/generate_data.html">generateData</a>
    <a class="dropdown-item" href="articles/analyze_data.html">analyzeData</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Background Reading</h6>
    <a class="dropdown-item" href="articles/simulation_overview.html">Simulation Overview</a>
    <a class="dropdown-item" href="articles/references.html">References</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MikeKSmith/MSToolkit/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="mstoolkit">MSToolkit<a class="anchor" aria-label="anchor" href="#mstoolkit"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The MSToolkit R package has been written to help users simulate clinical trials, evaluate designs, analysis methodology and quantify operating characteristics through the application of dose and study level decision criteria.</p>
<ul>
<li><p>Can simulate parallel group, crossover and longitudinal designs.</p></li>
<li><p>Flexibility in defining data generation processes using parametric models.</p></li>
<li><p>Data generation model parameters can vary across simulation replicates; parameters can vary between subjects.</p></li>
<li><p>The data generation function specifies the linear predictor for the mean response given inputs (dose, time, covariates); inverse link functions allow generation of continuous, binary and count data. User-written inverse link functions allow data generation from a variety of other distributions.</p></li>
<li><p>Model parameters and covariates for each subject / replicate can be generated from multivariate normal distributions or sampled from external data files e.g. existing data files.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The best way to install MSToolkit currently, is to install the development version directly from <a href="https://github.com/MikeKSmith/MSToolkit" class="external-link">GitHub</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"MikeKSmith/MSToolkit"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Most users will start with the <code><a href="reference/generateData.html">generateData()</a></code> which generates data and controlls dropout and missing data by specifying the design, allocation to treatments, generation of parameters, and functional specification. The function has a great number of arguments which control and pass information to the low level functions.</p>
<p>The generateData function iteratively builds and combines the data components for each replicate, the replicate datasets would be stored as individual .CSV files (“replicate000x.csv”) in the “ReplicateData” subdirectory of the working directory.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">MSToolkit</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/generateData.html">generateData</a></span><span class="op">(</span></span>
<span>  replicateN <span class="op">=</span> <span class="fl">500</span>, </span>
<span>  subjects <span class="op">=</span> <span class="fl">400</span>, </span>
<span>  treatDoses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span>, </span>
<span>  conCovNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wt"</span>, <span class="st">"age"</span><span class="op">)</span>, </span>
<span>  conCovMean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">83</span>, <span class="fl">55</span><span class="op">)</span> , </span>
<span>  conCovVCov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14</span>,<span class="fl">10</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> , </span>
<span>  conCovDigits <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  conCovCrit <span class="op">=</span> <span class="st">"18 &lt;= age &lt;= 65"</span>, </span>
<span>  genParNames <span class="op">=</span> <span class="st">"E0,ED50,EMAX"</span>, </span>
<span>  genParMean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">50</span>,<span class="fl">10</span><span class="op">)</span>, </span>
<span>  genParVCov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">30</span>,<span class="fl">10</span><span class="op">)</span> <span class="op">)</span>, </span>
<span>  genParBtwNames <span class="op">=</span> <span class="st">"E0,ED50,EMAX"</span>, </span>
<span>  genParBtwMean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, </span>
<span>  genParBtwVCov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, </span>
<span>  respEqn <span class="op">=</span> <span class="st">"E0 + ((DOSE * EMAX)/(DOSE + ED50))"</span>,  </span>
<span>  respVCov <span class="op">=</span> <span class="fl">5</span>, </span>
<span>  interimSubj <span class="op">=</span> <span class="st">".3,.7"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This example generates 500 .CSV files with 400 subjects each to store the </span></span>
<span><span class="co"># replicate datasets in the "ReplicateData" directory. </span></span></code></pre></div>
<p>Once data has been generated, the next step is to analyze the replicate data using the <code><a href="reference/analyzeData.html">analyzeData()</a></code>. This function wraps together functions for performing user-specified analysis on the replicate datasets and also performing micro- and macro- level summaries of the analysis results. The summary files are named “MicroSummary.csv” and “MacroSummary.csv” respectively, and stored in the current R working directory.</p>
<p>Besides, two directories called “MicroEvaluation” and “MacroEvaluation” are created under the current R working directory for the output of the analysisCode (“Micro000x.csv”) and macroCode (“Macro000x.csv”) functions respectively.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Standard analysis code</span></span>
<span><span class="va">emaxCode</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DoseResponse</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span> <span class="va">data</span>, </span>
<span>    <span class="op">{</span></span>
<span>    <span class="va">uniDoses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">)</span><span class="op">)</span>                                                                    </span>
<span>    <span class="va">eFit</span> <span class="op">&lt;-</span> <span class="fu">emaxalt</span><span class="op">(</span> <span class="va">RESP</span>, <span class="va">DOSE</span> <span class="op">)</span></span>
<span>    <span class="va">outDf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> DOSE <span class="op">=</span> <span class="va">uniDoses</span>, </span>
<span>      MEAN <span class="op">=</span> <span class="va">eFit</span><span class="op">$</span><span class="va">dm</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">uniDoses</span><span class="op">)</span><span class="op">]</span>, </span>
<span>      SE <span class="op">=</span> <span class="va">eFit</span><span class="op">$</span><span class="va">dsd</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">uniDoses</span><span class="op">)</span><span class="op">]</span> <span class="op">)</span></span>
<span>    <span class="va">outDf</span><span class="op">$</span><span class="va">LOWER</span> <span class="op">&lt;-</span> <span class="va">outDf</span><span class="op">$</span><span class="va">MEAN</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">outDf</span><span class="op">$</span><span class="va">SE</span></span>
<span>    <span class="va">outDf</span><span class="op">$</span><span class="va">UPPER</span> <span class="op">&lt;-</span> <span class="va">outDf</span><span class="op">$</span><span class="va">MEAN</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">outDf</span><span class="op">$</span><span class="va">SE</span></span>
<span>    <span class="va">outDf</span><span class="op">$</span><span class="va">N</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">)</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">uniDoses</span><span class="op">)</span> <span class="op">]</span></span>
<span>    <span class="va">outDf</span> </span>
<span>  <span class="op">}</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span>             </span>
<span><span class="co"># Macro evaluation code</span></span>
<span><span class="va">macrocode</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># making up a t-test</span></span>
<span>  <span class="va">mu0</span>   <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">MEAN</span><span class="op">[</span> <span class="va">data</span><span class="op">$</span><span class="va">DOSE</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">data</span><span class="op">$</span><span class="va">INTERIM</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span></span>
<span>  <span class="va">mu100</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">MEAN</span><span class="op">[</span> <span class="va">data</span><span class="op">$</span><span class="va">DOSE</span> <span class="op">==</span> <span class="fl">100</span> <span class="op">&amp;</span> <span class="va">data</span><span class="op">$</span><span class="va">INTERIM</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span></span>
<span>  <span class="va">n0</span>    <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">N</span><span class="op">[</span> <span class="va">data</span><span class="op">$</span><span class="va">DOSE</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">data</span><span class="op">$</span><span class="va">INTERIM</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span></span>
<span>  <span class="va">n100</span>  <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">N</span><span class="op">[</span> <span class="va">data</span><span class="op">$</span><span class="va">DOSE</span> <span class="op">==</span> <span class="fl">100</span> <span class="op">&amp;</span> <span class="va">data</span><span class="op">$</span><span class="va">INTERIM</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span></span>
<span>  <span class="va">sd0</span>   <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">SE</span><span class="op">[</span> <span class="va">data</span><span class="op">$</span><span class="va">DOSE</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">data</span><span class="op">$</span><span class="va">INTERIM</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span></span>
<span>  <span class="va">sd100</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">SE</span><span class="op">[</span> <span class="va">data</span><span class="op">$</span><span class="va">DOSE</span> <span class="op">==</span> <span class="fl">100</span> <span class="op">&amp;</span> <span class="va">data</span><span class="op">$</span><span class="va">INTERIM</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">sddiff</span> <span class="op">&lt;-</span> <span class="kw">if</span><span class="op">(</span> <span class="va">n0</span> <span class="op">==</span> <span class="va">n100</span> <span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span> <span class="op">(</span><span class="va">sd0</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">sd100</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>  <span class="op">/</span> <span class="op">(</span><span class="va">n0</span> <span class="op">+</span> <span class="va">n100</span><span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n0</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n100</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span> <span class="op">(</span><span class="va">n0</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">sd0</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">n100</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">sd100</span><span class="op">^</span><span class="fl">2</span>  <span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n0</span><span class="op">+</span><span class="va">n100</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span>  <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">tstat</span>  <span class="op">&lt;-</span> <span class="op">(</span> <span class="va">mu100</span> <span class="op">-</span> <span class="va">mu0</span> <span class="op">)</span> <span class="op">/</span> <span class="va">sddiff</span> </span>
<span>  <span class="va">success</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">tstat</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span> <span class="fl">.975</span>, <span class="va">n0</span><span class="op">+</span><span class="va">n100</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> SUCCESS <span class="op">=</span> <span class="va">success</span>, TSTAT <span class="op">=</span> <span class="va">tstat</span> <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span>  </span>
<span><span class="co"># Interim analysis code</span></span>
<span><span class="va">interimCode</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span> <span class="va">data</span> <span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">dropdose</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span> <span class="va">data</span>, <span class="va">DOSE</span> <span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">UPPER</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">LOWER</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">DOSE</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">]</span> <span class="op">)</span></span>
<span>  <span class="va">outList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dropdose</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">)</span> <span class="va">outList</span><span class="op">$</span><span class="va">DROP</span> <span class="op">&lt;-</span> <span class="va">dropdose</span></span>
<span>  <span class="va">outList</span><span class="op">$</span><span class="va">STOP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dropdose</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span>  <span class="va">outList</span></span>
<span><span class="op">}</span></span>
<span>   </span>
<span><span class="co"># Run analysis</span></span>
<span><span class="fu"><a href="reference/analyzeData.html">analyzeData</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, analysisCode <span class="op">=</span> <span class="va">emaxCode</span>, macroCode <span class="op">=</span> <span class="va">macrocode</span>, </span>
<span>  interimCode <span class="op">=</span> <span class="va">interimCode</span> <span class="op">)</span></span></code></pre></div>
<p>Furthermore, The analyzeData function can use the <em>parallel</em> package to split analysis across CPUs across cores on the compute resource it is running on. Specifying <code>grid = TRUE</code> splits the job across either (number of cores - 1) or <code>getOption("max.clusters")</code> whichever is the minimum. It is set to <code>FALSE</code> by default.</p>
</div>
<div class="section level2">
<h2 id="store-the-simulation-results">Store the simulation results<a class="anchor" aria-label="anchor" href="#store-the-simulation-results"></a>
</h2>
<p>By default, MSToolkit writes the Replicate, Micro- and Maco-evaluation datasets out to CSV format files, one for each simulation replicate. These are written to respective folders. The benefit of using CSV is the ability to easily view the simulated data or analysis results for each replicate, as well as the ability to share these with others. However, clearly this means that there will be three times as many CSV files as simulation replicates, which may be undesirable.</p>
<p>There is also the option to write the replicate data (simulated data) as .RData files or to keep the replicate data in memory. Micro- and macro-evaluation datasets are always written as CSV files.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># retrieve MSToolkit Data Method</span></span>
<span><span class="fu"><a href="reference/setEctdDataMethod.html">getEctdDataMethod</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'CSV'</span><span class="op">)</span>  </span>
<span></span>
<span></span>
<span><span class="co"># change the MSToolkit Data Method</span></span>
<span><span class="fu"><a href="reference/setEctdDataMethod.html">setEctdDataMethod</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'CSV'</span><span class="op">)</span>  </span>
<span><span class="co"># or setEctdDataMethod(method = 'RData')</span></span>
<span><span class="co"># or setEctdDataMethod(method = 'Internal')  </span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sas">SAS<a class="anchor" aria-label="anchor" href="#sas"></a>
</h2>
<p>Before using SAS as an analytical engine or using an external compute resource environment, it is important to set up preferences for the location of R and the SAS executable (if required). A file ECTD.ini is provided in the top directory of the library which should contain the following rows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Instructions to set up environmental variables</span></span>
<span></span>
<span><span class="co"># This option allows the setting of the R execution binary on a Linux grid</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span><span class="st">"RLSF_LINUX"</span><span class="op">=</span><span class="st">"."</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This option allows the setting of the SAS execution path on a Unix machine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span><span class="st">"SASPATH_UNIX"</span><span class="op">=</span><span class="st">"."</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This option allows the setting of the SAS execution path on a Windows machine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span><span class="st">"SASPATH_WIN"</span><span class="op">=</span><span class="st">"C:\\Program Files\\SAS Institute\\SAS\\V8\\sas.exe"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=MSToolkit" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/MikeKSmith/MSToolkit/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/MikeKSmith/MSToolkit/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing MSToolkit</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Mike K Smith <br><small class="roles"> Author, maintainer </small>  </li>
<li>Rich Pugh <br><small class="roles"> Author </small>  </li>
<li>Roman Francois <br><small class="roles"> Author </small>  </li>
<li>Francisco Gochez <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/jluo0015/MSToolkit/actions" class="external-link"><img src="https://github.com/jluo0015/MSToolkit/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://app.codecov.io/gh/jluo0015/MSToolkit?branch=Dev" class="external-link"><img src="https://codecov.io/gh/jluo0015/MSToolkit/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Mike K Smith, Rich Pugh, Roman Francois, Francisco Gochez.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
